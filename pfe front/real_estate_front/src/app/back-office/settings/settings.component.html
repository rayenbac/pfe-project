<div class="settings-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">
        <i class="fas fa-cog"></i>
        Settings & Configuration
      </h1>
      <div class="header-actions">
        <button class="btn btn-outline" (click)="exportSettings()">
          <i class="fas fa-download"></i>
          Export Settings
        </button>
        <label for="import-file" class="btn btn-outline">
          <i class="fas fa-upload"></i>
          Import Settings
        </label>
        <input 
          type="file" 
          id="import-file" 
          accept=".json" 
          (change)="importSettings($event)"
          style="display: none;"
        >
        <button class="btn btn-primary" (click)="clearCache()">
          <i class="fas fa-sync-alt"></i>
          Clear Cache
        </button>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div class="error-message" *ngIf="error">
    <i class="fas fa-exclamation-triangle"></i>
    {{ error }}
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading settings...</p>
  </div>

  <!-- Settings Content -->
  <div class="settings-content" *ngIf="!loading">
    <!-- Navigation Tabs -->
    <div class="settings-nav">
      <button 
        class="nav-item" 
        [class.active]="activeTab === 'website'"
        (click)="setActiveTab('website')">
        <i class="fas fa-globe"></i>
        Website Settings
      </button>
      <button 
        class="nav-item" 
        [class.active]="activeTab === 'payment'"
        (click)="setActiveTab('payment')">
        <i class="fas fa-credit-card"></i>
        Payment Settings
      </button>
      <button 
        class="nav-item" 
        [class.active]="activeTab === 'email'"
        (click)="setActiveTab('email')">
        <i class="fas fa-envelope"></i>
        Email Settings
      </button>
      <button 
        class="nav-item" 
        [class.active]="activeTab === 'seo'"
        (click)="setActiveTab('seo')">
        <i class="fas fa-search"></i>
        SEO Settings
      </button>
      <button 
        class="nav-item" 
        [class.active]="activeTab === 'security'"
        (click)="setActiveTab('security')">
        <i class="fas fa-shield-alt"></i>
        Security
      </button>
      <button 
        class="nav-item" 
        [class.active]="activeTab === 'roles'"
        (click)="setActiveTab('roles')">
        <i class="fas fa-users-cog"></i>
        Roles & Permissions
      </button>
    </div>

    <!-- Website Settings Tab -->
    <div class="tab-content" *ngIf="activeTab === 'website'">
      <div class="settings-card">
        <div class="card-header">
          <h2 class="card-title">Website Settings</h2>
          <p class="card-description">Configure your website's basic information and features</p>
        </div>
        
        <form [formGroup]="websiteForm" (ngSubmit)="saveWebsiteSettings()">
          <div class="form-grid">
            <div class="form-group">
              <label for="siteName">Site Name *</label>
              <input 
                type="text" 
                id="siteName" 
                formControlName="siteName"
                class="form-control"
                placeholder="Your Site Name"
              >
            </div>

            <div class="form-group">
              <label for="contactEmail">Contact Email *</label>
              <input 
                type="email" 
                id="contactEmail" 
                formControlName="contactEmail"
                class="form-control"
                placeholder="contact@yoursite.com"
              >
            </div>

            <div class="form-group full-width">
              <label for="siteDescription">Site Description</label>
              <textarea 
                id="siteDescription" 
                formControlName="siteDescription"
                class="form-control"
                rows="3"
                placeholder="Brief description of your website"
              ></textarea>
            </div>

            <div class="form-group">
              <label for="contactPhone">Contact Phone</label>
              <input 
                type="tel" 
                id="contactPhone" 
                formControlName="contactPhone"
                class="form-control"
                placeholder="+1 234 567 8900"
              >
            </div>

            <div class="form-group">
              <label for="address">Business Address</label>
              <input 
                type="text" 
                id="address" 
                formControlName="address"
                class="form-control"
                placeholder="123 Business Street, City, Country"
              >
            </div>

            <div class="form-group">
              <label for="currency">Currency *</label>
              <select id="currency" formControlName="currency" class="form-control">
                <option *ngFor="let currency of currencies" [value]="currency.code">
                  {{ currency.name }} ({{ currency.code }})
                </option>
              </select>
            </div>

            <div class="form-group">
              <label for="timezone">Timezone *</label>
              <select id="timezone" formControlName="timezone" class="form-control">
                <option *ngFor="let tz of timezones" [value]="tz.value">
                  {{ tz.name }}
                </option>
              </select>
            </div>

            <div class="form-group">
              <label for="language">Default Language *</label>
              <select id="language" formControlName="language" class="form-control">
                <option *ngFor="let lang of languages" [value]="lang.code">
                  {{ lang.name }}
                </option>
              </select>
            </div>
          </div>

          <!-- Logo Upload -->
          <div class="upload-section">
            <h3>Branding</h3>
            <div class="upload-grid">
              <div class="upload-group">
                <label>Site Logo</label>
                <div class="upload-area">
                  <input type="file" accept="image/*" (change)="uploadLogo($event)">
                  <div class="upload-placeholder">
                    <i class="fas fa-image"></i>
                    <span>Click to upload logo</span>
                  </div>
                </div>
              </div>
              <div class="upload-group">
                <label>Favicon</label>
                <div class="upload-area">
                  <input type="file" accept="image/*" (change)="uploadFavicon($event)">
                  <div class="upload-placeholder">
                    <i class="fas fa-star"></i>
                    <span>Click to upload favicon</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Feature Toggles -->
          <div class="toggles-section">
            <h3>Features</h3>
            <div class="toggles-grid">
              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableRegistration">
                  <span class="toggle-slider"></span>
                  User Registration
                </label>
                <p class="toggle-description">Allow new users to register accounts</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableSearch">
                  <span class="toggle-slider"></span>
                  Property Search
                </label>
                <p class="toggle-description">Enable property search functionality</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableNotifications">
                  <span class="toggle-slider"></span>
                  Notifications
                </label>
                <p class="toggle-description">Enable system notifications</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="maintenanceMode">
                  <span class="toggle-slider maintenance"></span>
                  Maintenance Mode
                </label>
                <p class="toggle-description">Enable maintenance mode (site will be unavailable)</p>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary" [disabled]="saving || !websiteForm.valid">
              <i class="fas fa-save" *ngIf="!saving"></i>
              <i class="fas fa-spinner fa-spin" *ngIf="saving"></i>
              {{ saving ? 'Saving...' : 'Save Website Settings' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Payment Settings Tab -->
    <div class="tab-content" *ngIf="activeTab === 'payment'">
      <div class="settings-card">
        <div class="card-header">
          <h2 class="card-title">Payment Settings</h2>
          <p class="card-description">Configure payment gateways and commission settings</p>
        </div>
        
        <form [formGroup]="paymentForm" (ngSubmit)="savePaymentSettings()">
          <!-- Payment Gateways -->
          <div class="gateway-section">
            <h3>Payment Gateways</h3>
            
            <!-- Stripe Settings -->
            <div class="gateway-card">
              <div class="gateway-header">
                <div class="gateway-info">
                  <h4>Stripe</h4>
                  <p>Accept credit cards, debit cards, and digital wallets</p>
                </div>
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableStripe">
                  <span class="toggle-slider"></span>
                </label>
              </div>
              <div class="gateway-fields" *ngIf="paymentForm.get('enableStripe')?.value">
                <div class="form-group">
                  <label for="stripePublicKey">Stripe Public Key</label>
                  <input 
                    type="text" 
                    id="stripePublicKey" 
                    formControlName="stripePublicKey"
                    class="form-control"
                    placeholder="pk_test_..."
                  >
                </div>
                <div class="form-group">
                  <label for="stripeSecretKey">Stripe Secret Key</label>
                  <input 
                    type="password" 
                    id="stripeSecretKey" 
                    formControlName="stripeSecretKey"
                    class="form-control"
                    placeholder="sk_test_..."
                  >
                </div>
              </div>
            </div>

            <!-- PayPal Settings -->
            <div class="gateway-card">
              <div class="gateway-header">
                <div class="gateway-info">
                  <h4>PayPal</h4>
                  <p>Accept PayPal payments and digital wallets</p>
                </div>
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enablePaypal">
                  <span class="toggle-slider"></span>
                </label>
              </div>
              <div class="gateway-fields" *ngIf="paymentForm.get('enablePaypal')?.value">
                <div class="form-group">
                  <label for="paypalClientId">PayPal Client ID</label>
                  <input 
                    type="text" 
                    id="paypalClientId" 
                    formControlName="paypalClientId"
                    class="form-control"
                    placeholder="PayPal Client ID"
                  >
                </div>
                <div class="form-group">
                  <label for="paypalClientSecret">PayPal Client Secret</label>
                  <input 
                    type="password" 
                    id="paypalClientSecret" 
                    formControlName="paypalClientSecret"
                    class="form-control"
                    placeholder="PayPal Client Secret"
                  >
                </div>
              </div>
            </div>

            <!-- Bank Transfer -->
            <div class="gateway-card">
              <div class="gateway-header">
                <div class="gateway-info">
                  <h4>Bank Transfer</h4>
                  <p>Accept manual bank transfer payments</p>
                </div>
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableBankTransfer">
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>
          </div>

          <!-- Commission & Fees -->
          <div class="commission-section">
            <h3>Commission & Fees</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="commissionRate">Commission Rate (%)</label>
                <input 
                  type="number" 
                  id="commissionRate" 
                  formControlName="commissionRate"
                  class="form-control"
                  min="0"
                  max="100"
                  step="0.1"
                >
              </div>

              <div class="form-group">
                <label for="processingFee">Processing Fee (%)</label>
                <input 
                  type="number" 
                  id="processingFee" 
                  formControlName="processingFee"
                  class="form-control"
                  min="0"
                  step="0.1"
                >
              </div>

              <div class="form-group">
                <label for="minimumWithdrawal">Minimum Withdrawal ($)</label>
                <input 
                  type="number" 
                  id="minimumWithdrawal" 
                  formControlName="minimumWithdrawal"
                  class="form-control"
                  min="0"
                >
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary" [disabled]="saving || !paymentForm.valid">
              <i class="fas fa-save" *ngIf="!saving"></i>
              <i class="fas fa-spinner fa-spin" *ngIf="saving"></i>
              {{ saving ? 'Saving...' : 'Save Payment Settings' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Email Settings Tab -->
    <div class="tab-content" *ngIf="activeTab === 'email'">
      <div class="settings-card">
        <div class="card-header">
          <h2 class="card-title">Email Settings</h2>
          <p class="card-description">Configure SMTP settings and email notifications</p>
        </div>
        
        <form [formGroup]="emailForm" (ngSubmit)="saveEmailSettings()">
          <!-- SMTP Configuration -->
          <div class="smtp-section">
            <h3>SMTP Configuration</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="smtpHost">SMTP Host *</label>
                <input 
                  type="text" 
                  id="smtpHost" 
                  formControlName="smtpHost"
                  class="form-control"
                  placeholder="smtp.gmail.com"
                >
              </div>

              <div class="form-group">
                <label for="smtpPort">SMTP Port *</label>
                <input 
                  type="number" 
                  id="smtpPort" 
                  formControlName="smtpPort"
                  class="form-control"
                  placeholder="587"
                >
              </div>

              <div class="form-group">
                <label for="smtpUsername">SMTP Username *</label>
                <input 
                  type="text" 
                  id="smtpUsername" 
                  formControlName="smtpUsername"
                  class="form-control"
                  placeholder="your-email@gmail.com"
                >
              </div>

              <div class="form-group">
                <label for="smtpPassword">SMTP Password *</label>
                <input 
                  type="password" 
                  id="smtpPassword" 
                  formControlName="smtpPassword"
                  class="form-control"
                  placeholder="Your app password"
                >
              </div>

              <div class="form-group">
                <label for="senderEmail">Sender Email *</label>
                <input 
                  type="email" 
                  id="senderEmail" 
                  formControlName="senderEmail"
                  class="form-control"
                  placeholder="noreply@yoursite.com"
                >
              </div>

              <div class="form-group">
                <label for="senderName">Sender Name *</label>
                <input 
                  type="text" 
                  id="senderName" 
                  formControlName="senderName"
                  class="form-control"
                  placeholder="Your Site Name"
                >
              </div>
            </div>

            <div class="test-connection">
              <button type="button" class="btn btn-outline" (click)="testEmailConnection()">
                <i class="fas fa-envelope-open-text"></i>
                Test Email Connection
              </button>
            </div>
          </div>

          <!-- Email Notifications -->
          <div class="notifications-section">
            <h3>Email Notifications</h3>
            <div class="toggles-grid">
              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableWelcomeEmail">
                  <span class="toggle-slider"></span>
                  Welcome Email
                </label>
                <p class="toggle-description">Send welcome email to new users</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableBookingConfirmation">
                  <span class="toggle-slider"></span>
                  Booking Confirmation
                </label>
                <p class="toggle-description">Send confirmation emails for bookings</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enablePaymentNotification">
                  <span class="toggle-slider"></span>
                  Payment Notifications
                </label>
                <p class="toggle-description">Send payment confirmation emails</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableWeeklyReports">
                  <span class="toggle-slider"></span>
                  Weekly Reports
                </label>
                <p class="toggle-description">Send weekly analytics reports</p>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary" [disabled]="saving || !emailForm.valid">
              <i class="fas fa-save" *ngIf="!saving"></i>
              <i class="fas fa-spinner fa-spin" *ngIf="saving"></i>
              {{ saving ? 'Saving...' : 'Save Email Settings' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- SEO Settings Tab -->
    <div class="tab-content" *ngIf="activeTab === 'seo'">
      <div class="settings-card">
        <div class="card-header">
          <h2 class="card-title">SEO Settings</h2>
          <p class="card-description">Configure search engine optimization settings</p>
        </div>
        
        <form [formGroup]="seoForm" (ngSubmit)="saveSEOSettings()">
          <!-- Meta Information -->
          <div class="meta-section">
            <h3>Meta Information</h3>
            <div class="form-group">
              <label for="metaTitle">Meta Title *</label>
              <input 
                type="text" 
                id="metaTitle" 
                formControlName="metaTitle"
                class="form-control"
                placeholder="Your site title for search engines"
              >
            </div>

            <div class="form-group">
              <label for="metaDescription">Meta Description *</label>
              <textarea 
                id="metaDescription" 
                formControlName="metaDescription"
                class="form-control"
                rows="3"
                placeholder="Brief description for search engine results"
              ></textarea>
            </div>

            <div class="form-group">
              <label for="metaKeywords">Meta Keywords</label>
              <input 
                type="text" 
                id="metaKeywords" 
                formControlName="metaKeywords"
                class="form-control"
                placeholder="keyword1, keyword2, keyword3"
              >
            </div>
          </div>

          <!-- Analytics & Tracking -->
          <div class="analytics-section">
            <h3>Analytics & Tracking</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="analyticsId">Google Analytics ID</label>
                <input 
                  type="text" 
                  id="analyticsId" 
                  formControlName="analyticsId"
                  class="form-control"
                  placeholder="GA4-XXXXXXXXX"
                >
              </div>

              <div class="form-group">
                <label for="googleSearchConsole">Google Search Console</label>
                <input 
                  type="text" 
                  id="googleSearchConsole" 
                  formControlName="googleSearchConsole"
                  class="form-control"
                  placeholder="Verification code"
                >
              </div>

              <div class="form-group">
                <label for="facebookPixel">Facebook Pixel ID</label>
                <input 
                  type="text" 
                  id="facebookPixel" 
                  formControlName="facebookPixel"
                  class="form-control"
                  placeholder="Facebook Pixel ID"
                >
              </div>
            </div>
          </div>

          <!-- SEO Features -->
          <div class="seo-features">
            <h3>SEO Features</h3>
            <div class="toggles-grid">
              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableSitemap">
                  <span class="toggle-slider"></span>
                  Generate Sitemap
                </label>
                <p class="toggle-description">Automatically generate XML sitemap</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableRobots">
                  <span class="toggle-slider"></span>
                  Robots.txt
                </label>
                <p class="toggle-description">Generate robots.txt file</p>
              </div>
            </div>

            <div class="seo-actions">
              <button type="button" class="btn btn-outline" (click)="generateSitemap()">
                <i class="fas fa-sitemap"></i>
                Generate Sitemap
              </button>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary" [disabled]="saving || !seoForm.valid">
              <i class="fas fa-save" *ngIf="!saving"></i>
              <i class="fas fa-spinner fa-spin" *ngIf="saving"></i>
              {{ saving ? 'Saving...' : 'Save SEO Settings' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Security Settings Tab -->
    <div class="tab-content" *ngIf="activeTab === 'security'">
      <div class="settings-card">
        <div class="card-header">
          <h2 class="card-title">Security Settings</h2>
          <p class="card-description">Configure security and authentication settings</p>
        </div>
        
        <form [formGroup]="securityForm" (ngSubmit)="saveSecuritySettings()">
          <!-- Authentication Settings -->
          <div class="auth-section">
            <h3>Authentication</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="maxLoginAttempts">Max Login Attempts</label>
                <input 
                  type="number" 
                  id="maxLoginAttempts" 
                  formControlName="maxLoginAttempts"
                  class="form-control"
                  min="1"
                  max="10"
                >
              </div>

              <div class="form-group">
                <label for="sessionTimeout">Session Timeout (minutes)</label>
                <input 
                  type="number" 
                  id="sessionTimeout" 
                  formControlName="sessionTimeout"
                  class="form-control"
                  min="1"
                >
              </div>
            </div>

            <div class="toggles-grid">
              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableTwoFactor">
                  <span class="toggle-slider"></span>
                  Two-Factor Authentication
                </label>
                <p class="toggle-description">Require 2FA for admin accounts</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="enableCaptcha">
                  <span class="toggle-slider"></span>
                  Enable CAPTCHA
                </label>
                <p class="toggle-description">Require CAPTCHA for login forms</p>
              </div>
            </div>

            <div class="form-group" *ngIf="securityForm.get('enableCaptcha')?.value">
              <label for="captchaSiteKey">reCAPTCHA Site Key</label>
              <input 
                type="text" 
                id="captchaSiteKey" 
                formControlName="captchaSiteKey"
                class="form-control"
                placeholder="reCAPTCHA site key"
              >
            </div>
          </div>

          <!-- Password Requirements -->
          <div class="password-section">
            <h3>Password Requirements</h3>
            <div class="form-group">
              <label for="passwordMinLength">Minimum Password Length</label>
              <input 
                type="number" 
                id="passwordMinLength" 
                formControlName="passwordMinLength"
                class="form-control"
                min="6"
                max="20"
              >
            </div>

            <div class="toggles-grid">
              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="requireUppercase">
                  <span class="toggle-slider"></span>
                  Require Uppercase
                </label>
                <p class="toggle-description">Password must contain uppercase letters</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="requireNumbers">
                  <span class="toggle-slider"></span>
                  Require Numbers
                </label>
                <p class="toggle-description">Password must contain numbers</p>
              </div>

              <div class="toggle-item">
                <label class="toggle-label">
                  <input type="checkbox" formControlName="requireSpecialChars">
                  <span class="toggle-slider"></span>
                  Require Special Characters
                </label>
                <p class="toggle-description">Password must contain special characters</p>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary" [disabled]="saving || !securityForm.valid">
              <i class="fas fa-save" *ngIf="!saving"></i>
              <i class="fas fa-spinner fa-spin" *ngIf="saving"></i>
              {{ saving ? 'Saving...' : 'Save Security Settings' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Roles & Permissions Tab -->
    <div class="tab-content" *ngIf="activeTab === 'roles'">
      <div class="settings-card">
        <div class="card-header">
          <h2 class="card-title">Roles & Permissions</h2>
          <p class="card-description">Manage user roles and their permissions</p>
          <button class="btn btn-primary" (click)="createRole()">
            <i class="fas fa-plus"></i>
            Create Role
          </button>
        </div>
        
        <div class="roles-grid">
          <div class="role-card" *ngFor="let role of roles">
            <div class="role-header">
              <div class="role-info">
                <h3 class="role-name">{{ role.name }}</h3>
                <span class="role-badge" [class.system]="role.isSystem">
                  {{ role.isSystem ? 'System Role' : 'Custom Role' }}
                </span>
              </div>
              <div class="role-actions" *ngIf="!role.isSystem">
                <button class="btn-icon" (click)="editRole(role)">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn-icon delete" (click)="deleteRole(role.id)">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>

            <div class="role-stats">
              <div class="stat">
                <span class="stat-value">{{ role.userCount }}</span>
                <span class="stat-label">Users</span>
              </div>
              <div class="stat">
                <span class="stat-value">{{ role.permissions.length }}</span>
                <span class="stat-label">Permissions</span>
              </div>
            </div>

            <div class="role-permissions">
              <h4>Permissions</h4>
              <div class="permissions-list">
                <span 
                  class="permission-tag" 
                  *ngFor="let permission of role.permissions"
                  [class.all]="permission === 'all'">
                  {{ permission === 'all' ? 'All Permissions' : permission.replace('_', ' ') | titlecase }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
